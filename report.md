
问卷调查表的结果为xlsx格式，我们在python对数据进行预处理，包括异常值筛除、基本信息处理、生活习惯与饮食情况处理、健康指标处理等步骤。

## BMI计算与异常值处理

根据**体重**和**身高**计算**BMI**指数。计算方法如下：

$$
BMI = 体重/身高^2
$$

注意：这里**体重**单位是kg，**身高**单位是m。

由于一些样本的**身高**或**体重**数据填写存在明显错误，我们以**BMI**>72为条件，删除异常**BMI**值的样本，并重置行索引。
    
## 基本信息处理

根据**出生年**计算**年龄**列，这里我们假设问卷年份为2023年。

根据问卷表中对应关系，处理**性别**、**民族**、**婚姻状况**、**文化程度**、**职业**等分类特征。

## 吸烟情况预处理

首先，根据**年龄**和**开始吸烟年龄**计算出**烟龄**。对于填写“记不清”的样本，我们假设其**开始吸烟年龄**为中国居民平均开始吸烟年龄19岁。其次，计算出平均每日吸烟支数**CPD**。最后，根据**烟龄**和**CPD**计算出**吸烟指数**。计算方法如下：

$$
吸烟指数 = 烟龄*CPD
$$

## 饮酒情况预处理

对于饮酒情况，我们计算每个样本的日均酒精摄入量。对不同种类的饮酒情况进行加权处理，取每种酒类的平均酒精含量。

|品类|酒精含量|
|:-:|:-:|
|高度白酒|45%|
|低度白酒|25%|
|啤酒|5%|
|黄酒、糯米酒|15%|
|葡萄酒|10%|


4. **进食情况预处理：**
   - 将进食情况进行二元编码。
   - 根据不同食物类别计算摄入量，如'大米'、'小麦面粉'、'杂粮'等。
   - 计算'全谷物'、'鱼禽蛋瘦肉'、'奶制品'、'含糖饮料'、'食用油'、'盐'等。

5. **体育锻炼情况预处理：**
   - 对'是否参加体育锻炼'进行编码。
   - 填充'平均每天体育锻炼时间'的缺失值。
   - 根据锻炼情况计算'体育锻炼'。

6. **血压血糖血脂尿酸情况预处理：**
   - 根据收缩压和舒张压计算'血压水平'，根据血压值进行分类。
   - 根据空腹血糖值计算'糖代谢状态'，根据血糖值进行分类。
   - 根据胆固醇、甘油三酯、高密度脂蛋白、低密度脂蛋白的值计算'血脂水平'，根据不同指标值进行分类。
   - 根据尿酸值和性别计算'尿酸水平'，根据尿酸值进行分类。



综上所述，这个程序通过多个预处理步骤，对原始数据进行了清洗、计算和特征提取，生成了一个更具信息价值和结构化的数据集。每个步骤都针对不同特征或指标进行了处理，以确保数据的准确性和可用性，为进一步的数据分析和建模提供了更好的基础。
