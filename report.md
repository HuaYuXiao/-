
问卷调查表的结果为xlsx格式，我们在python对数据进行预处理，包括异常值筛除、基本信息处理、生活习惯与饮食情况处理、健康指标处理等步骤。

## BMI计算与异常值处理

根据**体重**和**身高**计算**BMI**指数。计算方法如下：

$$
BMI = 体重 / 身高^2
$$

注意：这里**体重**单位是千克，**身高**单位是米。

由于一些样本的**身高**或**体重**数据填写存在明显错误，我们以**BMI**>72为条件，删除异常**BMI**值的样本，以确保数据的真实可信。
    
## 基本信息处理

根据**出生年**计算**年龄**列，这里我们假设问卷年份为2023年。

根据问卷表中对应关系，处理**性别**、**民族**、**婚姻状况**、**文化程度**、**职业**等分类特征。

## 吸烟情况预处理

首先，根据**年龄**和**开始吸烟年龄**计算出**烟龄**。对于填写“记不清”的样本，我们假设其**开始吸烟年龄**为中国居民平均开始吸烟年龄19岁。其次，计算出平均每日吸烟支数**CPD**。最后，根据**烟龄**和**CPD**计算出**吸烟指数**。计算方法如下：

$$
吸烟指数 = 烟龄 * CPD
$$

## 饮酒情况处理

对于饮酒情况，我们计算每个样本的日均**酒精**摄入量。对不同种类的饮酒情况进行加权处理，取每种酒类的平均酒精含量。对应关系如下表：

|酒的品类|酒精含量|
|:-:|:-:|
|高度白酒|45%|
|低度白酒|25%|
|啤酒|5%|
|黄酒、糯米酒|15%|
|葡萄酒|10%|

## 饮食习惯处理

### 全谷物、鱼禽蛋瘦肉、奶制品、大豆制品

**全谷物**包括**大米**、**小麦面粉**和**杂粮**。将原始单位两换算成以克为单位。

**鱼禽蛋瘦肉**包括**水产类**、**禽肉**和**蛋类**。这里各种**蛋类**取平均值50克/颗。

**奶制品**包括**鲜奶**、**奶粉**和**酸奶**。这里假设一勺**奶粉**换算成**50克**鲜奶**。

**大豆制品**包括**豆腐**、**豆腐丝**、**豆浆**和**干豆**。对不同种类的大豆制品进行加权处理，取其平均大豆含量。对应关系如下表：

|大豆制品|大豆含量|
|:-:|:-:|
|豆腐|22%|
|豆腐丝|67%|
|豆浆|6%|
|干豆|100%|

### 含糖饮料

**含糖饮料**包括**果汁饮料**和**其他饮料**。对于这两类饮料，分别计算其平均含糖量，以克/杯为单位。对应关系如下表：

|含糖饮料|含糖量|
|:-:|:-:|
|果汁饮料|53|
|其他饮料|43.5|

### 食用油、盐

问卷表中，**食用油**和**盐**的食用量以家庭为单位，我们换算成以个人为单位。查阅资料发现，中国家庭平均人口为2.62。

## 体育锻炼情况处理

计算每人每天体育锻炼时间。

## 健康指标处理

### 血压水平

根据**收缩压**和**舒张压**计算**血压水平**，根据血压值进行分类。分类依据如下表：

|血压水平|收缩压|舒张压|
|:-:|:-:|:-:|
|单纯收缩期高血压|>=140|<90|
|3级高血压|>=180|>=110|
|2级高血压|>=160|>=100|
|1级高血压|>=140|>=90|
|高血压|>=140|>=90|
|正常高值|>=100|>=80|

### 糖代谢状态

根据**空腹血糖**值计算**糖代谢状态**，根据血糖值进行分类。分类依据如下表：

|糖代谢状态|空腹血糖|
|:-:|:-:|
|糖尿病|>=7.0|
|空腹血糖受损|>=6.1|

### 血脂水平

根据**胆固醇**、**甘油三酯**和**高密度脂蛋白**的值计算**血脂水平**，根据不同指标值进行分类。分类依据如下表：

|血脂水平|胆固醇|甘油三酯|高密度脂蛋白|
|:-:|:-:|:-:|:-:|
|高胆固醇血症|>5.72|<=1.70||
|高甘油三酯血症|<=5.72|>1.70||
|混合型高脂血症|>5.72|>1.70||
|低高密度脂蛋白血症|||<0.90|

### 尿酸水平

根据**尿酸值**计算**尿酸水平**，根据**性别**和尿酸值进行分类。

|尿酸水平|尿酸值|性别|
|:-:|:-:|:-:|
|高尿酸血症|>420|男|
|高尿酸血症|>360|女|
